day1_rep1 <- interval(rep1_water_removal, rep1_water_removal + days(1))
day2_rep1 <- interval(rep1_water_removal + days(1), rep1_water_removal + days(2))
day3_rep1 <- interval(rep1_water_removal + days(2), rep1_water_removal + days(3))
rep2_water_removal <- ymd_hms("2022-10-30 11:59:59", tz="EST")
baseline_rep2 <- interval(rep2_water_removal - days(3), rep2_water_removal)
day1_rep2 <- interval(rep2_water_removal, rep2_water_removal + days(1))
day2_rep2 <- interval(rep2_water_removal + days(1), rep2_water_removal + days(2))
day3_rep2 <- interval(rep2_water_removal + days(2), rep2_water_removal + days(3))
rep3_water_removal <- ymd_hms("2022-12-03 11:59:59", tz="EST")
baseline_rep3 <- interval(rep3_water_removal - days(3), rep3_water_removal)
day1_rep3 <- interval(rep3_water_removal, rep3_water_removal + days(1))
day2_rep3 <- interval(rep3_water_removal + days(1), rep3_water_removal + days(2))
day3_rep3 <- interval(rep3_water_removal + days(2), rep3_water_removal + days(3))
baseline_temp_rep1 <- interval(rep1_water_removal - days(30), rep1_water_removal)
baseline_temp_rep2 <- interval(rep2_water_removal - days(30), rep2_water_removal)
baseline_temp_rep3 <- interval(rep3_water_removal - days(30), rep3_water_removal)
lowfat_dehydration_noOL_rep1 <- lowfat_dehydration_noOL_rep1 %>%
mutate(replicate = "rep1")
lowfat_dehydration_noOL_rep1 <- lowfat_dehydration_noOL_rep1 %>%
add_column(experiment_day = NA)
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 == "TRUE"] <- "baseline"
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% day1_rep1 == "TRUE"] <- "day1"
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% day2_rep1 == "TRUE"] <- "day2"
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% day3_rep1 == "TRUE"] <- "day3"
write.csv(lowfat_dehydration_noOL_rep1, "lowfat_dehydration_rep1.csv", row.names = FALSE)
lowfat_dehydration_noOL_rep2 <- lowfat_dehydration_noOL_rep2 %>%
add_column(experiment_day = NA)
lowfat_dehydration_noOL_rep2 <- lowfat_dehydration_noOL_rep2 %>%
mutate(replicate = "rep2")
lowfat_dehydration_noOL_rep2$experiment_day[lowfat_dehydration_noOL_rep2$DateTime %within% baseline_rep2 == "TRUE"] <- "baseline"
lowfat_dehydration_noOL_rep2$experiment_day[lowfat_dehydration_noOL_rep2$DateTime %within% day1_rep2 == "TRUE"] <- "day1"
lowfat_dehydration_noOL_rep2$experiment_day[lowfat_dehydration_noOL_rep2$DateTime %within% day2_rep2 == "TRUE"] <- "day2"
lowfat_dehydration_noOL_rep2$experiment_day[lowfat_dehydration_noOL_rep2$DateTime %within% day3_rep2 == "TRUE"] <- "day3"
lowfat_dehydration_noOL_rep2a <- lowfat_dehydration_noOL_rep2
lowfat_dehydration_noOL_rep2b <- lowfat_dehydration_noOL_rep2
lowfat_dehydration_noOL_rep2c <- lowfat_dehydration_noOL_rep2
lowfat_dehydration_noOL_rep2 <- rbind(lowfat_dehydration_noOL_rep2a, lowfat_dehydration_noOL_rep2b, lowfat_dehydration_noOL_rep2c)
write.csv(lowfat_dehydration_noOL_rep2, "lowfat_dehydration_rep2.csv", row.names = FALSE)
###### make data frames that contain all the data for a given interval.
baseline_temps <-
rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% baseline_temp_rep1,],
mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% baseline_temp_rep2,])
day1_temps <-
rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day1_rep1,],
mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% day1_rep2,])
day2_temps <-
rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day2_rep1,],
mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% day2_rep2,])
day3_temps <-
rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day3_rep1,],
mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% day3_rep2,])
baseline <-
rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1,],
lowfat_dehydration_noOL_rep2[lowfat_dehydration_noOL_rep2$DateTime %within% baseline_rep2,])
day1 <-
rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day1_rep1,],
lowfat_dehydration_noOL_rep2[lowfat_dehydration_noOL_rep2$DateTime %within% day1_rep2,])
day2 <-
rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day2_rep1,],
lowfat_dehydration_noOL_rep2[lowfat_dehydration_noOL_rep2$DateTime %within% day2_rep2,])
day3 <-
rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day3_rep1,],
lowfat_dehydration_noOL_rep2[lowfat_dehydration_noOL_rep2$DateTime %within% day3_rep2,])
#baseline_temps <-
#  rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within%  baseline_temp_rep1,], #mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% baseline_temp_rep2,] )
#day1_temps <-
#  rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day1_rep1,])
#day2_temps <-
#  rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day2_rep1,])
#day3_temps <-
#  rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day3_rep1,])
#baseline <-
#  rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1,])
#day1 <-
#  rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day1_rep1,])
#day2 <-
#  rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day2_rep1,])
#day3 <-
#  rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day3_rep1,])
coeff <- 0
temperatures <- ggplot(data = test_day1_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.1))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"), span=0.2)+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (째C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (째C)"))+
guides(alpha = "none")+
#facet_wrap(~sex) +
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.1))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"), span=0.2)+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (째C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (째C)"))+
guides(alpha = "none")+
#facet_wrap(~sex) +
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
library(devtools)
library(tidyverse)
library(lubridate)
library(readr)
library(viridis)
library(patchwork)
library(tidyselect)
library(readxl)
library(broom)
library(cowplot)
library(DescTools)
library(ggpubr)
library(plyr)
library(pwr)
library(Cairo)
library(ggpattern)
library(timeDate)
library(mgcv)
library(MASS)
library(dplyr)
setwd("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/R/lowfat_dehydration/")
path <- "C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep1/"
source("functions.R")
mouse_metadata_rep3 <- read_excel("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/mouse_data.xlsx",
sheet = "rep3_new", col_types = c("text",
"numeric", "numeric", "text", "text",
"numeric", "text", "text", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "text"))
mouse_metadata_rep1 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep1/mouse_data_rep1.csv",skip_empty_rows=TRUE) %>%
mutate(date, date = as.Date(date, format = "%d-%m-%y", tz="EST")) %>%
unite("DateTime", date:time, remove = FALSE, sep =  " ") %>%
mutate(DateTime = as.POSIXlt(DateTime), tz="EST")
mouse_metadata_rep2 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep2/lowfat_dehydration_temps_rep2.csv",skip_empty_rows=TRUE) %>%
mutate(date, date = as.Date(date, format = "%d-%m-%y", tz="EST")) %>%
unite("DateTime", date:time, remove = FALSE, sep =  " ") %>%
mutate(DateTime = as.POSIXlt(DateTime), tz="EST")
mouse_metadata_rep3 <- read_excel("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/mouse_data.xlsx",
sheet = "rep3_new", col_types = c("text",
"numeric", "numeric", "text", "text",
"numeric", "text", "text", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "numeric", "numeric",
"numeric", "text"))
#this is for room temperature
chunk1 <- bring_in_data_rep1("chunk1.csv")
chunk1 <- chunk1 %>% mutate(DateTime = with_tz(DateTime, tz="EST") + hours(1))
chunk1_act <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_baseline/chunk1_activity.csv", n_max=dim(chunk1)[1])
#this is the physiology data for the dehydration part of the experiment rep2
path <- "C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/"
ldr3 <- bring_in_data_rep2("lowfat_dehydrated_rep3.csv")
ldr3 <- ldr2a %>% mutate(DateTime = with_tz(DateTime, tz="EST") + hours(1))
ldr3_act <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/lowfat_dehydrated_rep3_activity.csv", n_max=dim(ldr2a)[1])
ldr3_temps <- bring_in_temps_rep3("bring_in_temps_rep3.csv")
ldr3_temps <- bring_in_temps_rep3("temps_rep3.csv")
view(ldr3_temps)
rawtemps <- read_csv(temps_rep3.csv, skip_empty_rows=TRUE,
col_types = cols(date = col_date(format = "%m/%d/%Y"),
time = col_time(format = "%H:%M:%S")))
rawtemps <- read_csv("temps_rep3.csv", skip_empty_rows=TRUE,
col_types = cols(date = col_date(format = "%m/%d/%Y"),
time = col_time(format = "%H:%M:%S")))
rawtemps <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/temps_rep3.csv", skip_empty_rows=TRUE,
col_types = cols(date = col_date(format = "%m/%d/%Y"),
time = col_time(format = "%H:%M:%S")))
library(readr)
temps_rep3a <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/temps_rep3.csv",
col_types = cols(date = col_date(format = "%m/%d/%Y"),
time = col_time(format = "%H:%M:%S")))
View(temps_rep3a)
problems()
problems(temps_rep3a)
library(readr)
temps_rep3 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/temps_rep3.csv",
col_types = cols(date = col_date(format = "%m/%d/%Y"),
time = col_time(format = "%H:%M:%S")),
na = "NA")
View(temps_rep3)
source("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/R/lowfat_dehydration/functions.r")
ldr3_temps <- bring_in_temps_rep3("temps_rep3.csv")
problems(ldr3_temps)
ldr3_temps <- bring_in_temps_rep3("temps_rep3.csv")
view(ldr3_temps)
rawtemps <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/temps_rep3.csv", skip_empty_rows=TRUE,
col_types = cols(date = col_date(format = "%m/%d/%Y"),
time = col_time(format = "%H:%M:%S")), na = "NA")
view(rawtemps)
library(readr)
temps_rep3 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/temps_rep3.csv",
col_types = cols(date = col_date(format = "%m/%d/%Y"),
time = col_time(format = "%H:%M:%S")),
na = "NA")
View(temps_rep3)
problems(temps_rep3)
?read_csv
library(readr)
temps_rep3 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/temps_rep3.csv",
col_types = cols(date = col_date(format = "%m/%d/%Y"),
time = col_time(format = "%H:%M:%S")),
na = NA)
library(readr)
temps_rep3 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/temps_rep3.csv",
col_types = cols(date = col_date(format = "%m/%d/%Y"),
time = col_time(format = "%H:%M:%S")),
na = empty)
library(readr)
temps_rep3 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/temps_rep3.csv",
col_types = cols(date = col_date(format = "%m/%d/%Y"),
time = col_time(format = "%H:%M:%S")),
na = "empty")
View(temps_rep3)
problems(temps_rep3)
library(readr)
temps_rep3 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/temps_rep3.csv",
col_types = cols(date = col_date(format = "%m/%d/%Y"),
time = col_time(format = "%H:%M:%S")),
na = "empty")
View(temps_rep3)
library(readr)
temps_rep3 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/temps_rep3.csv",
col_types = cols(date = col_date(format = "%m/%d/%Y"),
time = col_time(format = "%H:%M:%S")),
na = "NA")
View(temps_rep3)
library(readr)
temps_rep3 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/temps_rep3.csv",
col_types = cols(date = col_date(format = "%m/%d/%Y"),
time = col_time(format = "%H:%M:%S")),
na = "")
View(temps_rep3)
problems(temps_rep3)
library(readr)
temps_rep3 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/temps_rep3.csv",
col_types = cols(date = col_date(format = "%m/%d/%Y"),
time = col_time(format = "%H:%M:%S")),
na = " ")
View(temps_rep3)
problems(temps_rep3)
library(readr)
temps_rep3 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/temps_rep3.csv",
col_types = cols(date = col_date(format = "%m/%d/%Y"),
time = col_time(format = "%H:%M:%S")),
na = "")
View(temps_rep3)
problems(temps_rep3)
library(readr)
temps_rep3 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/temps_rep3.csv",
col_types = cols(date = col_date(format = "%m/%d/%Y"),
time = col_time(format = "%H:%M:%S")),
na = "NA")
View(temps_rep3)
problems(temps_rep3)
library(readr)
temps_rep3 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/temps_rep3.csv",
col_types = cols(date = col_date(format = "%m/%d/%Y"),
time = col_time(format = "%H:%M:%S")),
na = "")
View(temps_rep3)
problems(temps_rep3)
source("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/R/lowfat_dehydration/functions.r")
source("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/R/lowfat_dehydration/functions.r")
rm(ldr3_temps)
ldr3_temps <- bring_in_temps_rep3("temps_rep3.csv")
view(ldr3_temps )
source("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/R/lowfat_dehydration/functions.r")
ldr3_temps <- bring_in_temps_rep3("temps_rep3.csv")
ldr3_temps
rawtemps
view(rawtemps)
rm(rawtemps)
ldr3_temps <- bring_in_temps_rep3("temps_rep3.csv")
view(rawtemps)
library(readr)
temps_rep3 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/temps_rep3.csv",
col_types = cols(date = col_date(format = "%m/%d/%Y"),
time = col_time(format = "%H:%M:%S")),
na = "")
View(temps_rep3)
target <- c(001,002,003,004,005,006,007)
tempscages <- temps_rep3  %>% filter(AntennaID %in% target)
view(tempscages )
temps_rep3  %>% filter(AntennaID %in% target)
temps_rep3
source("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/R/lowfat_dehydration/functions.r")
ldr3_temps <- bring_in_temps_rep3("temps_rep3.csv")
view(ldr3_temps )
ldr3_temps %>% mutate(date, date = as.Date(date, format = "%Y-%m-%f", tz="EST"))
ldr3_temps
ldr3_temps %>% mutate(date, date = as.Date(date, format = "%Y-%m-%f", tz="EST")) %>% unite("DateTime", date:time, remove = FALSE, sep =  " ")
ldr3_temps %>% mutate(date, date = as.Date(date, format = "%Y-%m-%f", tz="EST")) %>% unite("DateTime", date:time, remove = FALSE, sep =  " ") %>% mutate(DateTime = as.POSIXlt(DateTime), tz="EST")
ldr3_temps %>% mutate(date, date = as.Date(date, format = "%Y-%m-%f", tz="EST")) %>% unite("DateTime", date:time, remove = FALSE, sep =  " ") %>% mutate(DateTime = as.POSIXlt(DateTime, tz="EST"))
source("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/R/lowfat_dehydration/functions.r")
source("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/R/lowfat_dehydration/functions.r")
ldr3_temps <- bring_in_temps_rep3("temps_rep3.csv")
view(ldr3_temps)
dim(lowfat_dehydration_noOL_rep3)
###################ldr3
#make activity data non-cumulative
ldr3 <- ldr3 %>%
add_column(MOD_ADX = ldr3_act$MOD_ADX) %>%
mutate(Activity = MOD_ADX - lag(MOD_ADX, default = 0))
#this is the physiology data for the dehydration part of the experiment rep2
path <- "C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/"
ldr3 <- bring_in_data_rep2("lowfat_dehydrated_rep3.csv")
ldr3 <- ldr2a %>% mutate(DateTime = with_tz(DateTime, tz="EST") + hours(1))
ldr3_act <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/lowfat_dehydrated_rep3_activity.csv", n_max=dim(ldr3)[1])
ldr3_temps <- bring_in_temps_rep3("temps_rep3.csv")
###################ldr3
#make activity data non-cumulative
ldr3 <- ldr3 %>%
add_column(MOD_ADX = ldr3_act$MOD_ADX) %>%
mutate(Activity = MOD_ADX - lag(MOD_ADX, default = 0))
#this is the physiology data for the dehydration part of the experiment rep3
path <- "C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/"
ldr3 <- bring_in_data_rep3("lowfat_dehydrated_rep3.csv")
ldr3 <- ldr3 %>% mutate(DateTime = with_tz(DateTime, tz="EST") + hours(1))
ldr3_act <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep3/lowfat_dehydrated_rep3_activity.csv", n_max=dim(ldr3)[1])
ldr3_temps <- bring_in_temps_rep3("temps_rep3.csv")
###################ldr3
#make activity data non-cumulative
ldr3 <- ldr3 %>%
add_column(MOD_ADX = ldr3_act$MOD_ADX) %>%
mutate(Activity = MOD_ADX - lag(MOD_ADX, default = 0))
#subset out baseline data
baseline <- c(7)
baseline_cage <- ldr3 %>%
filter(Animal %in% baseline)
#subset out animal data
target <- c(0,1,2,3,4,5,6)
cages <- ldr3 %>%
filter(Animal %in% target)
cages <- cages %>%
dplyr::select(Animal_ID, sex, DateTime, date, time, weight, Activity, EE, H2Omg,
H2Oml, Deg_C, CO2, VO2, VCO2, RQ, SD_VO2, SD_VCO2, SD_H2Oml,
SD_H2Omg, SS4_FR, H2O_WVP, BP)
ldr3_cages <- cages
#rep2_cages <- rbind(ldr2_cages, ldr2a_cages, ldr2b_cages)
#here is the outlier removal part
count = 1
dependent_variables = c("EE", "RQ", "VO2", "VCO2", "H2Omg", "Activity")
varname_list = c("EE_OLs","RQ_OLs","VO2_OLs","VCO2_OLs","H2O_OLs", "Activity_OLs")
for (DV in dependent_variables){
print(DV)
model <- lm(as.formula(paste0(DV, " ~ Animal_ID")), data = ldr3_cages)
model.metrics <- augment(model) %>% dplyr::select(-.hat, -.sigma, -.fitted)
summ <- model.metrics %>% filter(abs(.std.resid) > 2) %>% as.data.frame()
OL_list = c()
masterlist = c()
for (each_outlier_row in 1:nrow(summ)){
this_weight <- summ[each_outlier_row, "Animal_ID"]
this_DV  <- summ[each_outlier_row, DV]
OL_list <- c(OL_list, (which(ldr3_cages$Animal_ID == this_weight & ldr3_cages[DV] == this_DV)))
}
print(OL_list)
#Assign list of outliers to specified variable lists (OL_list_EE, RQ, VO2, VCO2, mgH2O)
assign(paste("OL_list_", DV, sep = ""), OL_list)
}
masterlist <- c(OL_list_EE, OL_list_RQ, OL_list_VO2, OL_list_VCO2, OL_list_H2Omg, OL_list_Activity)
masterlist_noDup <- unique(masterlist)
lowfat_dehydration_noOL_rep3 <- ldr3_cages[-c(masterlist_noDup),]
view(lowfat_dehydration_noOL_rep3)
dim(lowfat_dehydration_noOL_rep3)
rep1_water_removal <- ymd_hms("2022-10-06 11:59:59", tz="EST")
baseline_rep1 <- interval(rep1_water_removal - days(3), rep1_water_removal)
day1_rep1 <- interval(rep1_water_removal, rep1_water_removal + days(1))
day2_rep1 <- interval(rep1_water_removal + days(1), rep1_water_removal + days(2))
day3_rep1 <- interval(rep1_water_removal + days(2), rep1_water_removal + days(3))
rep2_water_removal <- ymd_hms("2022-10-30 11:59:59", tz="EST")
baseline_rep2 <- interval(rep2_water_removal - days(3), rep2_water_removal)
day1_rep2 <- interval(rep2_water_removal, rep2_water_removal + days(1))
day2_rep2 <- interval(rep2_water_removal + days(1), rep2_water_removal + days(2))
day3_rep2 <- interval(rep2_water_removal + days(2), rep2_water_removal + days(3))
rep3_water_removal <- ymd_hms("2022-12-06 11:59:59", tz="EST")
baseline_rep3 <- interval(rep3_water_removal - days(3), rep3_water_removal)
day1_rep3 <- interval(rep3_water_removal, rep3_water_removal + days(1))
day2_rep3 <- interval(rep3_water_removal + days(1), rep3_water_removal + days(2))
day3_rep3 <- interval(rep3_water_removal + days(2), rep3_water_removal + days(3))
baseline_temp_rep1 <- interval(rep1_water_removal - days(30), rep1_water_removal)
baseline_temp_rep2 <- interval(rep2_water_removal - days(30), rep2_water_removal)
baseline_temp_rep3 <- interval(rep3_water_removal - days(3), rep3_water_removal)
lowfat_dehydration_noOL_rep3 <- lowfat_dehydration_noOL_rep3 %>%
add_column(experiment_day = NA)
lowfat_dehydration_noOL_rep3 <- lowfat_dehydration_noOL_rep3 %>%
mutate(replicate = "rep3")
lowfat_dehydration_noOL_rep3$experiment_day[lowfat_dehydration_noOL_rep3$DateTime %within% baseline_rep3 == "TRUE"] <- "baseline"
lowfat_dehydration_noOL_rep3$experiment_day[lowfat_dehydration_noOL_rep3$DateTime %within% day1_rep3 == "TRUE"] <- "day1"
lowfat_dehydration_noOL_rep3$experiment_day[lowfat_dehydration_noOL_rep3$DateTime %within% day2_rep3 == "TRUE"] <- "day2"
lowfat_dehydration_noOL_rep3$experiment_day[lowfat_dehydration_noOL_rep3$DateTime %within% day3_rep3 == "TRUE"] <- "day3"
lowfat_dehydration_noOL_rep3a <- lowfat_dehydration_noOL_rep3
lowfat_dehydration_noOL_rep3b <- lowfat_dehydration_noOL_rep3
lowfat_dehydration_noOL_rep3c <- lowfat_dehydration_noOL_rep3
lowfat_dehydration_noOL_rep3 <- rbind(lowfat_dehydration_noOL_rep3a, lowfat_dehydration_noOL_rep3b, lowfat_dehydration_noOL_rep3c)
write.csv(lowfat_dehydration_noOL_rep3, "lowfat_dehydration_rep3.csv", row.names = FALSE)
ldr3_temps[mouse_metadata_rep3$DateTime %within% baseline_temp_rep3,],
ldr3_temps[mouse_metadata_rep3$DateTime %within% baseline_temp_rep3,]
view(ldr3_temps)
ldr3_temps[ldr3_temps$DateTime %within% baseline_temp_rep3,]
lowfat_dehydration_noOL_rep3[lowfat_dehydration_noOL_rep3$DateTime %within% baseline_rep3,]
###### make data frames that contain all the data for a given interval.
baseline_temps <-
rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% baseline_temp_rep1,],
mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% baseline_temp_rep2,],
ldr3_temps[ldr3_temps$DateTime %within% baseline_temp_rep3,])
baseline <-
rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1,],
lowfat_dehydration_noOL_rep2[lowfat_dehydration_noOL_rep2$DateTime %within% baseline_rep2,],
lowfat_dehydration_noOL_rep3[lowfat_dehydration_noOL_rep3$DateTime %within% baseline_rep3,])
ldr3_temps[ldr3_temps$DateTime %within% baseline_temp_rep3,]
basline_temps <- ldr3_temps[ldr3_temps$DateTime %within% baseline_temp_rep3,]
coeff <- 0
temperatures <- ggplot(data = basline_temps ,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.1))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"), span=0.2)+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (째C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (째C)"))+
guides(alpha = "none")+
#facet_wrap(~sex) +
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
cols <- c("Baseline"="navyblue","Day 1"="sienna1","Day 2"="sienna3", "Day 3"="sienna4")
EE <- ggplot(data = baseline,aes(x=as.POSIXct(time),y=EE)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.1))+
geom_point(data = day1, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3, aes(color="Day 3", alpha=0.2))+
theme_classic()+
ylim(0,0.4) +
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "", y = expression(EE ~ (KiloJoules ~ h^-1)))+
guides(alpha = "none")+
facet_wrap(~sex) +
scale_colour_manual(name="Dehydration",values=cols, guide="none")
EE
dim(baseline)
dim(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1,])
dim(lowfat_dehydration_noOL_rep2[lowfat_dehydration_noOL_rep2$DateTime %within% baseline_rep2,])
dim(lowfat_dehydration_noOL_rep3[lowfat_dehydration_noOL_rep3$DateTime %within% baseline_rep3,])
head(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% baseline_temp_rep1,])
head(ldr3_temps[ldr3_temps$DateTime %within% baseline_temp_rep3,])
0.46*60*60
.46*1440
0.06*(3.941*0.4276738 + 1.106*0.3937564))
0.06*(3.941*0.4276738 + 1.106*0.3937564)
6.39E+01*2
5.17E+01*2
1440*(3.941*127 + 1.106*108)
892735.2/24
60*(3.941*0.4276738 + 1.106*0.3937564)
41.868860*(3.941*0.4276738 + 1.106*0.3937564)
41.8688*60*(3.941*0.4276738 + 1.106*0.3937564)
41.868*60*(3.941*0.4276738 + 1.106*0.3937564)
4.1868*60*(3.941*0.4276738 + 1.106*0.3937564)
