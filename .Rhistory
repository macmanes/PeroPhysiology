temperatures
?geom_smooth
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"), span=.1)+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline", span=.1))+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"), span=.01)+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"), span=0)+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='loess', se = FALSE, aes(color = "Baseline"), span=0)+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='loess', se = FALSE, aes(color = "Baseline"), span=.25)+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='loess', se = FALSE, aes(color = "Baseline"), span=.75)+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"), span=.1)+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
dim(baseline_temps)
mouse_metadata_rep2 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep2/mouse_data_rep2.csv",skip_empty_rows=TRUE) %>%
mutate(date, date = as.Date(date, format = "%d-%m-%y", tz="EST")) %>%
unite("DateTime", date:time, remove = FALSE, sep =  " ") %>%
mutate(DateTime = as.POSIXlt(DateTime), tz="EST")
baseline_temps <-
rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within%  baseline_temp_rep1,], mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% baseline_temp_rep2,] )
dim(baseline_temps)
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"), span=0.2)+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
library(chron)
install.packages("chron")
library(chron)
detach("package:chron", unload = TRUE)
period_to_seconds(hms("01:00:00"))
lubridate::period_to_seconds(hms("01:00:00"))
library(lubridate)
install.packages(c("brew", "car", "classInt", "cli", "commonmark", "confintr", "cpp11", "crayon", "curl", "data.table", "DescTools", "devtools", "digest", "dplyr", "e1071", "evaluate", "Exact", "fontawesome", "gert", "ggpmisc", "ggpp", "ggridges", "ggsignif", "gld", "httpuv", "isoband", "jsonlite", "lifecycle", "maptools", "MatrixModels", "minqa", "openssl", "pkgload", "processx", "ps", "purrr", "ragg", "RcppArmadillo", "readr", "rlang", "rmarkdown", "shiny", "sys", "testthat", "tibble", "tidyr", "tidyselect", "timeDate", "tinytex", "vctrs", "vroom", "wk", "xfun", "XML", "xts", "yaml", "zip", "zoo"))
install.packages(c("brew", "car", "classInt", "cli", "commonmark", "confintr", "cpp11", "crayon", "curl", "data.table", "DescTools", "devtools", "digest", "dplyr", "e1071", "evaluate", "Exact", "fontawesome", "gert", "ggpmisc", "ggpp", "ggridges", "ggsignif", "gld", "httpuv", "isoband", "jsonlite", "lifecycle", "maptools", "MatrixModels", "minqa", "openssl", "pkgload", "processx", "ps", "purrr", "ragg", "RcppArmadillo", "readr", "rlang", "rmarkdown", "shiny", "sys", "testthat", "tibble", "tidyr", "tidyselect", "timeDate", "tinytex", "vctrs", "vroom", "wk", "xfun", "XML", "xts", "yaml", "zip", "zoo"))
install.packages(c("brew", "car", "classInt", "cli", "commonmark", "confintr", "cpp11", "crayon", "curl", "data.table", "DescTools", "devtools", "digest", "dplyr", "e1071", "evaluate", "Exact", "fontawesome", "gert", "ggpmisc", "ggpp", "ggridges", "ggsignif", "gld", "httpuv", "isoband", "jsonlite", "lifecycle", "maptools", "MatrixModels", "minqa", "openssl", "pkgload", "processx", "ps", "purrr", "ragg", "RcppArmadillo", "readr", "rlang", "rmarkdown", "shiny", "sys", "testthat", "tibble", "tidyr", "tidyselect", "timeDate", "tinytex", "vctrs", "vroom", "wk", "xfun", "XML", "xts", "yaml", "zip", "zoo"))
lubridate::period_to_seconds(hms("01:00:00"))
period_to_seconds(hms("01:00:00"))
period_to_seconds(hms(lowfat_dehydration_noOL_rep1$time))
period_to_seconds(hms(lowfat_dehydration_noOL_rep1$time))
lowfat_dehydration_noOL_rep1$time
lowfat_dehydration_noOL_rep1
dd
dd$time
summary(dd$ctime)
summary(dd$time)
cages$time
chunk5$time
ldr1
ldr1www <- bring_in_data("lowfat_dehydrated_rep1.csv")
library(devtools)
library(tidyverse)
ldr1www <- bring_in_data("lowfat_dehydrated_rep1.csv")
library(devtools)
install.packages(c("cli", "data.table", "devtools", "digest", "dplyr", "ggpmisc", "ggsignif", "purrr", "rlang", "shiny", "tibble", "vctrs", "xfun"))
install.packages(c("cli", "data.table", "devtools", "digest", "dplyr", "ggpmisc", "ggsignif", "purrr", "rlang", "shiny", "tibble", "vctrs", "xfun"))
install.packages(c("cli", "data.table", "devtools", "digest", "dplyr", "ggpmisc", "ggsignif", "purrr", "rlang", "shiny", "tibble", "vctrs", "xfun"))
install.packages(c("cli", "data.table", "devtools", "digest", "dplyr", "ggpmisc", "ggsignif", "purrr", "rlang", "shiny", "tibble", "vctrs", "xfun"))
install.packages(c("cli", "data.table", "devtools", "digest", "dplyr", "ggpmisc", "ggsignif", "purrr", "rlang", "shiny", "tibble", "vctrs", "xfun"))
install.packages("devtools")
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
library(devtools)
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
library(usethis)
library(rlang)
library(rlang==1.0.6)
library(rlang=1.0.6)
library(rlang = 1.0.6)
library(rlang=1.0.6)
library(devtools)
remove.packages("rlang")
install.packages(rlang)
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
install.packages("devtools")
install.packages(c("cli", "digest", "ggpmisc", "ggsignif", "shiny", "vctrs", "xfun"))
install.packages(c("cli", "digest", "ggpmisc", "ggsignif", "shiny", "vctrs", "xfun"))
install.packages(c("cli", "digest", "ggpmisc", "ggsignif", "shiny", "vctrs", "xfun"))
library(devtools)
library(tidyverse)
library(lubridate)
library(readr)
library(viridis)
library(patchwork)
library(tidyselect)
library(readxl)
library(broom)
library(cowplot)
library(DescTools)
library(ggpubr)
library(plyr)
library(dplyr)
library(pwr)
library(Cairo)
library(ggpattern)
library(hms)
mouse_metadata_rep2 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep2/mouse_data_rep2.csv",skip_empty_rows=TRUE) %>%
mutate(date, date = as.Date(date, format = "%d-%m-%y", tz="EST")) %>%
unite("DateTime", date:time, remove = FALSE, sep =  " ") %>%
mutate(DateTime = as.POSIXlt(DateTime), tz="EST")
baseline_temps <-
rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within%  baseline_temp_rep1,], mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% baseline_temp_rep2,] )
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"), span=0.2)+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = if(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1,] = "TRUE"){print("baseline")})
lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1,]
lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1]
lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1
lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = if(lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 = "TRUE"){print("baseline")})
lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = if(lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 = "TRUE"){print("baseline")})
lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1
lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = if(lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 == "TRUE"){print("baseline")})
lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = if(lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 == "TRUE"){print("baseline")})
test <- c("TRUE", "FAL", "TRUE")
lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = if(test == "TRUE"){print("baseline")})
test
lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = ifelse(test == "TRUE"){print("baseline")})
lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = test == "TRUE" <- basline)
lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = test == "TRUE" <- "baseline")
lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = test =="TRUE" <- "baseline")
lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = test =="T" <- "baseline")
lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = dd$lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 == "TRUE"] <- "baseline")
test1 <- lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = dd$lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 == "TRUE"] <- "baseline")
test1$experiment_day
test1 <- lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = dd$lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 == TRUE] <- "baseline")
test1$experiment_day
test1 <- lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 == TRUE] <- "baseline")
lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1
lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1
test1 <- lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 == TRUE] <- "baseline")
test1 <- lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 == TRUE <- "baseline")
test1 <- lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = [lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 == TRUE] <- "baseline")
test1 <- lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 == TRUE] <- "baseline")
test1 <- lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 == "TRUE"] <- "baseline")
test1 <- lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 = "TRUE"] <- "baseline")
test1 <- lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = lowfat_dehydration_noOL_rep1[DateTime %within% baseline_rep1 = "TRUE"] <- "baseline")
lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1
]
lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 = "TRUE"]
lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1]
lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1]
lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1,]
lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1]
lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1
dd$Animal_ID[dd$Animal_ID == "6" & dd$doy > 100] <- "6a"
dd$Animal_ID
lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = "")
lowfat_dehydration_noOL_rep1 <- lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day = "")
lowfat_dehydration_noOL_rep1 $experiment_day
lowfat_dehydration_noOL_rep1 <- lowfat_dehydration_noOL_rep1 %>%
mutate(experiment_day =)
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 == "TRUE"] <- "baseline"
lowfat_dehydration_noOL_rep1 $experiment_day
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 == "TRUE"] <- "baseline"
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% day1_rep1 == "TRUE"] <- "day1"
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% day2_rep1 == "TRUE"] <- "day1"
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% day3_rep1 == "TRUE"] <- "day3"
lowfat_dehydration_noOL_rep1 $experiment_day
lowfat_dehydration_noOL_rep1 <- lowfat_dehydration_noOL_rep1 %>%
add_column(experiment_day = NA)
lowfat_dehydration_noOL_rep1 <- lowfat_dehydration_noOL_rep1 %>%
remove(experiment_day)
lowfat_dehydration_noOL_rep1 <- lowfat_dehydration_noOL_rep1 %>%
select(-experiment_day)
lowfat_dehydration_noOL_rep1 <- lowfat_dehydration_noOL_rep1 %>%
add_column(experiment_day = NA)
lowfat_dehydration_noOL_rep1
dim(cages)
count = 1
dependent_variables = c("EE", "RQ", "VO2", "VCO2", "H2Omg", "Activity")
varname_list = c("EE_OLs","RQ_OLs","VO2_OLs","VCO2_OLs","H2O_OLs", "Activity_OLs")
for (DV in dependent_variables){
print(DV)
model <- lm(as.formula(paste0(DV, " ~ Animal_ID")), data = cages)
model.metrics <- augment(model) %>% select(-.hat, -.sigma, -.fitted)
summ <- model.metrics %>% filter(abs(.std.resid) > 2) %>% as.data.frame()
OL_list = c()
masterlist = c()
for (each_outlier_row in 1:nrow(summ)){
this_weight <- summ[each_outlier_row, "Animal_ID"]
this_DV  <- summ[each_outlier_row, DV]
OL_list <- c(OL_list, (which(cages$Animal_ID == this_weight & cages[DV] == this_DV)))
}
print(OL_list)
#Assign list of outliers to specified variable lists (OL_list_EE, RQ, VO2, VCO2, mgH2O)
assign(paste("OL_list_", DV, sep = ""), OL_list)
}
masterlist <- c(OL_list_EE, OL_list_RQ, OL_list_VO2, OL_list_VCO2, OL_list_H2Omg, OL_list_Activity)
masterlist_noDup <- unique(masterlist)
lowfat_dehydration_noOL_rep1 <- cages[-c(masterlist_noDup),]
dim(lowfat_dehydration_noOL_rep1)
lowfat_dehydration_noOL_rep1 <- lowfat_dehydration_noOL_rep1 %>%
add_column(experiment_day = NA)
lowfat_dehydration_noOL_rep1$experiment_day
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 == "TRUE"] <- "baseline"
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% day1_rep1 == "TRUE"] <- "day1"
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% day2_rep1 == "TRUE"] <- "day1"
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% day3_rep1 == "TRUE"] <- "day3"
lowfat_dehydration_noOL_rep1$experiment_day
count(lowfat_dehydration_noOL_rep1$experiment_day == "baseline")
count(lowfat_dehydration_noOL_rep1$experiment_day == "day1")
count(lowfat_dehydration_noOL_rep1$experiment_day == "day2")
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1 == "TRUE"] <- "baseline"
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% day1_rep1 == "TRUE"] <- "day1"
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% day2_rep1 == "TRUE"] <- "day2"
lowfat_dehydration_noOL_rep1$experiment_day[lowfat_dehydration_noOL_rep1$DateTime %within% day3_rep1 == "TRUE"] <- "day3"
count(lowfat_dehydration_noOL_rep1$experiment_day == "baseline")
count(lowfat_dehydration_noOL_rep1$experiment_day == "day1")
count(lowfat_dehydration_noOL_rep1$experiment_day == "day2")
count(lowfat_dehydration_noOL_rep1$experiment_day == "day3")
write.csv(lowfat_dehydration_noOL_rep1, "lowfat_dehydration.csv", row.names = FALSE)
lowfat_dehydration_noOL_rep1$time
period_to_seconds(lowfat_dehydration_noOL_rep1$time)
period_to_seconds(hms(lowfat_dehydration_noOL_rep1$time))
summary(lowfat_dehydration_noOL_rep1$time)
lowfat_dehydration_noOL_rep1$time[1]
period_to_seconds(lowfat_dehydration_noOL_rep1$time[1])
period_to_seconds(hms(lowfat_dehydration_noOL_rep1$time[1]))
hms(lowfat_dehydration_noOL_rep1$time[1])
as.POSIXct(lowfat_dehydration_noOL_rep1$time[1])
period_to_seconds(as.POSIXct(lowfat_dehydration_noOL_rep1$time[1]))
dd <- as.data.frame(lowfat_dehydration_noOL_rep1)
dd
summary(lowfat_dehydration_noOL_rep1)
index <- c(1,8)
for (i in index) dd[,i] <- as.factor(dd[,i])
summary(dd)
library(timeDate)
dd
dd#time
dd$time
period_to_seconds("02:28:56")
period_to_seconds(hms("02:28:56"))
period_to_seconds(hms(02:28:56))
hms(02:28:56)
hms(02:28:56)
remove(hms)
remove.packages(hms)
remove.packages("hms")
hms()
?hms
hms(02:28:56)
hms("02:28:56")
hms("12:28:56")
hms(12:28:56)
period_to_seconds(12:28:56)
?period_to_seconds
period_to_seconds(hms("01:00:00"))
lubridate::period_to_seconds(hms("01:00:00"))
period_to_seconds(hms("12:34:45"))
