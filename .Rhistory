source("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/R/lowfat_dehydration/functions.r")
chunk5 <- bring_in_data("chunk5.csv")
source("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/R/lowfat_dehydration/functions.r")
chunk5 <- bring_in_data("chunk5.csv")
chunk5_act <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_baseline/chunk5_activity.csv", n_max=dim(chunk5)[1])
ldr1 <- bring_in_data("lowfat_dehydrated_rep1.csv")
ldr1_act <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep1/lowfat_dehydrated_rep1_activity.csv", n_max=dim(ldr1)[1])
###################CHUNK5
#make activity data non-cumulative
chunk5 <- chunk5 %>%
add_column(MOD_ADX = chunk5_act$MOD_ADX) %>%
mutate(Activity = MOD_ADX - lag(MOD_ADX, default = 0))
#dates <- unique(chunk5$date)
#chunk5$day <- match(chunk5$date, dates)
#subset out baseline data
baseline <- c(7)
baseline_cage <- chunk5 %>%
filter(Animal %in% baseline)
baseline_cage <- baseline_cage %>%  mutate(DateTime = round_date(ymd_hms(as.POSIXct(baseline_cage$DateTime)), unit="min"))
#subset out animal data
target <- c(0,1,2,3,4,5,6)
cages <- chunk5 %>%
filter(Animal %in% target)
cages <- cages %>%
mutate(DateTime = round_date(ymd_hms(as.POSIXct(cages$DateTime)), unit="min")) %>%
select(Animal_ID, sex, DateTime, date, time, weight, Activity, EE, H2Omg,
H2Oml, Deg_C, CO2, VO2, VCO2, RQ, SD_VO2, SD_VCO2, SD_H2Oml,
SD_H2Omg, SS4_FR, H2O_WVP, BP)
chunk5 <- cages
###################CHUNK1
chunk1 <- chunk1 %>%
add_column(MOD_ADX = chunk1_act$MOD_ADX) %>%
mutate(Activity = MOD_ADX - lag(MOD_ADX, default = 0))
chunk5 <- bring_in_data("chunk5.csv")
chunk5_act <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_baseline/chunk5_activity.csv", n_max=dim(chunk5)[1])
chunk1 <- bring_in_data("chunk1.csv")
ldr1 <- bring_in_data("lowfat_dehydrated_rep1.csv")
ldr1_act <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep1/lowfat_dehydrated_rep1_activity.csv", n_max=dim(ldr1)[1])
###################CHUNK5
#make activity data non-cumulative
chunk5 <- chunk5 %>%
add_column(MOD_ADX = chunk5_act$MOD_ADX) %>%
mutate(Activity = MOD_ADX - lag(MOD_ADX, default = 0))
#dates <- unique(chunk5$date)
#chunk5$day <- match(chunk5$date, dates)
#subset out baseline data
baseline <- c(7)
baseline_cage <- chunk5 %>%
filter(Animal %in% baseline)
baseline_cage <- baseline_cage %>%  mutate(DateTime = round_date(ymd_hms(as.POSIXct(baseline_cage$DateTime)), unit="min"))
#subset out animal data
target <- c(0,1,2,3,4,5,6)
cages <- chunk5 %>%
filter(Animal %in% target)
cages <- cages %>%
mutate(DateTime = round_date(ymd_hms(as.POSIXct(cages$DateTime)), unit="min")) %>%
select(Animal_ID, sex, DateTime, date, time, weight, Activity, EE, H2Omg,
H2Oml, Deg_C, CO2, VO2, VCO2, RQ, SD_VO2, SD_VCO2, SD_H2Oml,
SD_H2Omg, SS4_FR, H2O_WVP, BP)
chunk5 <- cages
###################CHUNK1
chunk1 <- chunk1 %>%
add_column(MOD_ADX = chunk1_act$MOD_ADX) %>%
mutate(Activity = MOD_ADX - lag(MOD_ADX, default = 0))
chunk5 <- bring_in_data("chunk5.csv")
chunk5_act <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_baseline/chunk5_activity.csv", n_max=dim(chunk5)[1])
chunk1 <- bring_in_data("chunk1.csv")
chunk1_act <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_baseline/chunk1_activity.csv", n_max=dim(chunk1)[1])
ldr1 <- bring_in_data("lowfat_dehydrated_rep1.csv")
ldr1_act <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep1/lowfat_dehydrated_rep1_activity.csv", n_max=dim(ldr1)[1])
###################CHUNK5
#make activity data non-cumulative
chunk5 <- chunk5 %>%
add_column(MOD_ADX = chunk5_act$MOD_ADX) %>%
mutate(Activity = MOD_ADX - lag(MOD_ADX, default = 0))
#dates <- unique(chunk5$date)
#chunk5$day <- match(chunk5$date, dates)
#subset out baseline data
baseline <- c(7)
baseline_cage <- chunk5 %>%
filter(Animal %in% baseline)
baseline_cage <- baseline_cage %>%  mutate(DateTime = round_date(ymd_hms(as.POSIXct(baseline_cage$DateTime)), unit="min"))
#subset out animal data
target <- c(0,1,2,3,4,5,6)
cages <- chunk5 %>%
filter(Animal %in% target)
cages <- cages %>%
mutate(DateTime = round_date(ymd_hms(as.POSIXct(cages$DateTime)), unit="min")) %>%
select(Animal_ID, sex, DateTime, date, time, weight, Activity, EE, H2Omg,
H2Oml, Deg_C, CO2, VO2, VCO2, RQ, SD_VO2, SD_VCO2, SD_H2Oml,
SD_H2Omg, SS4_FR, H2O_WVP, BP)
chunk5 <- cages
###################CHUNK1
chunk1 <- chunk1 %>%
add_column(MOD_ADX = chunk1_act$MOD_ADX) %>%
mutate(Activity = MOD_ADX - lag(MOD_ADX, default = 0))
#dates <- unique(chunk5$date)
#chunk5$day <- match(chunk5$date, dates)
#subset out baseline data
baseline <- c(7)
baseline_cage <- chunk1 %>%
filter(Animal %in% baseline)
baseline_cage <- baseline_cage %>%  mutate(DateTime = round_date(ymd_hms(as.POSIXct(baseline_cage$DateTime)), unit="min"))
#subset out animal data
target <- c(0,1,2,3,4,5,6)
cages <- chunk1 %>%
filter(Animal %in% target)
cages <- cages %>%
mutate(DateTime = round_date(ymd_hms(as.POSIXct(cages$DateTime)), unit="min")) %>%
select(Animal_ID, sex, DateTime, date, time, weight, Activity, EE, H2Omg,
H2Oml, Deg_C, CO2, VO2, VCO2, RQ, SD_VO2, SD_VCO2, SD_H2Oml,
SD_H2Omg, SS4_FR, H2O_WVP, BP)
chunk1 <- cages
###################ldr1
ldr1 <- ldr1 %>%
add_column(MOD_ADX = ldr1_act$MOD_ADX) %>%
mutate(Activity = MOD_ADX - lag(MOD_ADX, default = 0))
#dates <- unique(chunk5$date)
#chunk5$day <- match(chunk5$date, dates)
#subset out baseline data
baseline <- c(7)
baseline_cage <- ldr1 %>%
filter(Animal %in% baseline)
baseline_cage <- baseline_cage %>%  mutate(DateTime = round_date(ymd_hms(as.POSIXct(baseline_cage$DateTime)), unit="min"))
#subset out animal data
target <- c(0,1,2,3,4,5,6)
cages <- ldr1 %>%
filter(Animal %in% target)
cages <- cages %>%
mutate(DateTime = round_date(ymd_hms(as.POSIXct(cages$DateTime)), unit="min")) %>%
select(Animal_ID, sex, DateTime, date, time, weight, Activity, EE, H2Omg,
H2Oml, Deg_C, CO2, VO2, VCO2, RQ, SD_VO2, SD_VCO2, SD_H2Oml,
SD_H2Omg, SS4_FR, H2O_WVP, BP)
ldr1 <- cages
cages <- rbind(ldr1, chunk5)
#here is the outlier removal part
count = 1
dependent_variables = c("EE", "RQ", "VO2", "VCO2", "H2Omg", "Activity")
varname_list = c("EE_OLs","RQ_OLs","VO2_OLs","VCO2_OLs","H2O_OLs", "Activity_OLs")
for (DV in dependent_variables){
print(DV)
model <- lm(as.formula(paste0(DV, " ~ Animal_ID")), data = cages)
model.metrics <- augment(model) %>% select(-.hat, -.sigma, -.fitted)
summ <- model.metrics %>% filter(abs(.std.resid) > 2) %>% as.data.frame()
OL_list = c()
masterlist = c()
for (each_outlier_row in 1:nrow(summ)){
this_weight <- summ[each_outlier_row, "Animal_ID"]
this_DV  <- summ[each_outlier_row, DV]
OL_list <- c(OL_list, (which(cages$Animal_ID == this_weight & cages[DV] == this_DV)))
}
print(OL_list)
#Assign list of outliers to specified variable lists (OL_list_EE, RQ, VO2, VCO2, mgH2O)
assign(paste("OL_list_", DV, sep = ""), OL_list)
}
masterlist <- c(OL_list_EE, OL_list_RQ, OL_list_VO2, OL_list_VCO2, OL_list_H2Omg, OL_list_Activity)
masterlist_noDup <- unique(masterlist)
lowfat_dehydration_noOL_rep1 <- cages[-c(masterlist_noDup),]
#write.csv(all_noOL_M, "all_noOL_M.csv", row.names = FALSE)
rep1_water_removal <- ymd_hms("2022-10-06 11:59:59", tz="EST")
baseline_rep1 <- interval(rep1_water_removal - days(3), rep1_water_removal)
day1_rep1 <- interval(rep1_water_removal, rep1_water_removal + days(1))
day2_rep1 <- interval(rep1_water_removal + days(1), rep1_water_removal + days(2))
day3_rep1 <- interval(rep1_water_removal + days(2), rep1_water_removal + days(3))
rep2_water_removal <- ymd_hms("2022-10-26 11:59:59", tz="EST")
baseline_rep2 <- interval(rep2_water_removal - days(3), rep2_water_removal)
day1_rep2 <- interval(rep2_water_removal, rep2_water_removal + days(1))
day2_rep2 <- interval(rep2_water_removal + days(1), rep2_water_removal + days(2))
day3_rep2 <- interval(rep2_water_removal + days(2), rep2_water_removal + days(3))
coeff <- 0
temperatures <- ggplot(data = mouse_metadata_rep1[mouse_metadata_rep1$water == "yes",],
aes(x=as.POSIXct(time) + hours(0),y=body_temp)) +
theme_classic()+
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct(as_hms("00:00:00")),
xmax = as.POSIXct(as_hms("06:00:00")),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct(as_hms("21:00:00")),
xmax = as.POSIXct(as_hms("23:59:59")),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(group=as.factor(water),
color="navyblue"), show.legend = FALSE)+
geom_smooth(method='gam')+
theme(axis.text.y=element_text(size=12))+
geom_point(data = mouse_metadata_rep1[mouse_metadata_rep1$water == "no",],
aes(x=as.POSIXct(time) + hours(0),y=body_temp, color="red")) +
geom_point(data = chunk5, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,43), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none", size= "none", color= "none")+
theme(axis.text.x=element_blank()) +
scale_color_manual(values = c("navyblue", "red", "black"))
temperatures
coeff <- 0
temperatures <- ggplot(data = mouse_metadata_rep1[mouse_metadata_rep1$water == "yes",],
aes(x=as.POSIXct(time) + hours(0),y=body_temp)) +
theme_classic()+
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct(as_hms("00:00:00")),
xmax = as.POSIXct(as_hms("06:00:00")),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct(as_hms("21:00:00")),
xmax = as.POSIXct(as_hms("23:59:59")),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(group=as.factor(water),
color="navyblue"), show.legend = FALSE)+
geom_smooth(method='gam')+
theme(axis.text.y=element_text(size=12))+
geom_point(data = mouse_metadata_rep1[mouse_metadata_rep1$water == "no",],
aes(x=as.POSIXct(time) + hours(0),y=body_temp, color="red")) +
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,43), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none", size= "none", color= "none")+
theme(axis.text.x=element_blank()) +
scale_color_manual(values = c("navyblue", "red", "black"))
temperatures
lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% baseline,]
lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1,]
baseline_test <- rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1,],lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day1_rep1,])
dim(baseline_test )
dim(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1,])
baseline_test <-
rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1,],
lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day1_rep1,])
lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1,]
mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% baseline_rep1,]
rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1,])
baseline_temps <-
rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% baseline_rep1,])
dim(baseline_temps )
rep1_water_removal <- ymd_hms("2022-10-06 11:59:59", tz="EST")
baseline_rep1 <- interval(rep1_water_removal - days(3), rep1_water_removal)
day1_rep1 <- interval(rep1_water_removal, rep1_water_removal + days(1))
day2_rep1 <- interval(rep1_water_removal + days(1), rep1_water_removal + days(2))
day3_rep1 <- interval(rep1_water_removal + days(2), rep1_water_removal + days(3))
rep2_water_removal <- ymd_hms("2022-10-26 11:59:59", tz="EST")
baseline_rep2 <- interval(rep2_water_removal - days(3), rep2_water_removal)
day1_rep2 <- interval(rep2_water_removal, rep2_water_removal + days(1))
day2_rep2 <- interval(rep2_water_removal + days(1), rep2_water_removal + days(2))
day3_rep2 <- interval(rep2_water_removal + days(2), rep2_water_removal + days(3))
baseline_temps <-
rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% baseline_rep1,])
day1_temps <-
rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day1_rep1,])
day2_temps <-
rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day2_rep1,])
day3_temps <-
rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day3_rep1,])
baseline <-
rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1,])
day1 <-
rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day1_rep1,])
day2 <-
rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day2_rep1,])
day3 <-
rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day3_rep1,])
###### for future use
#baseline_temps <-
#  rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% baseline_rep1,],
#        mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% baseline_rep2,])
#day1_temps <-
#  rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day1_rep1,],
#        mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% day1_rep2,])
#day2_temps <-
#  rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day2_rep1,],
#        mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% day2_rep2,])
#day3_temps <-
#  rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day3_rep1,],
#        mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% day3_rep2,])
#baseline <-
#  rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1,],
#        lowfat_dehydration_noOL_rep2[lowfat_dehydration_noOL_rep2$DateTime %within% baseline_rep2,])
#day1 <-
#  rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day1_rep1,],
#        lowfat_dehydration_noOL_rep2[lowfat_dehydration_noOL_rep2$DateTime %within% day1_rep2,])
#day2 <-
#  rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day2_rep1,],
#        lowfat_dehydration_noOL_rep2[lowfat_dehydration_noOL_rep2$DateTime %within% day2_rep2,])
#day3 <-
#  rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day3_rep1,],
#        lowfat_dehydration_noOL_rep2[lowfat_dehydration_noOL_rep2$DateTime %within% day3_rep2,])
cols <- c("Baseline"="navyblue","Day 1"="sienna1","Day 2"="sienna3", "Day 3"="sienna4")
EE <- ggplot(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% baseline,],aes(x=as.POSIXct(time),y=EE)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day1,], aes(color="Day 1", alpha=0.2))+
geom_point(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day2,], aes(color="Day 2", alpha=0.2))+
geom_point(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day3,], aes(color="Day 3", alpha=0.2))+
theme_classic()+
ylim(0,0.5) +
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day1,], method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day2,], method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day3,], method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "", y = expression(EE ~ (KiloJoules ~ h^-1)))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
baseline
lowfat_dehydration_noOL <- lowfat_dehydration_noOL_rep1
cols <- c("Baseline"="navyblue","Day 1"="sienna1","Day 2"="sienna3", "Day 3"="sienna4")
EE <- ggplot(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% baseline,],aes(x=as.POSIXct(time),y=EE)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day1,], aes(color="Day 1", alpha=0.2))+
geom_point(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day2,], aes(color="Day 2", alpha=0.2))+
geom_point(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day3,], aes(color="Day 3", alpha=0.2))+
theme_classic()+
ylim(0,0.5) +
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day1,], method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day2,], method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day3,], method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "", y = expression(EE ~ (KiloJoules ~ h^-1)))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
baseline
cols <- c("Baseline"="navyblue","Day 1"="sienna1","Day 2"="sienna3", "Day 3"="sienna4")
EE <- ggplot(data = baseline,aes(x=as.POSIXct(time),y=EE)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3, aes(color="Day 3", alpha=0.2))+
theme_classic()+
ylim(0,0.5) +
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "", y = expression(EE ~ (KiloJoules ~ h^-1)))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
EE
dim(day1)
dim(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day1_rep1,],)
dim(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day1_rep1,])
dim(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day1_rep1,])
lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day1,]
lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day1_rep1,]
dim(lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day1_rep1,])
lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day1_rep1,]
view(lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day1_rep1,])
dim(lowfat_dehydration_noOL)
dim(lowfat_dehydration_noOL_rep1)
dim(ldr1)
dim(chunk5)
dim(cages)
dim(masterlist_noDup)
length(masterlist_noDup)
cols <- c("Baseline"="navyblue","Day 1"="sienna1","Day 2"="sienna3", "Day 3"="sienna4")
EE <- ggplot(data = baseline,aes(x=as.POSIXct(time),y=EE)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3, aes(color="Day 3", alpha=0.2))+
theme_classic()+
ylim(0,0.4) +
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "", y = expression(EE ~ (KiloJoules ~ h^-1)))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
EE
activity <- ggplot(data = baseline,aes(x=as.POSIXct(time),y=Activity)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3, aes(color="Day 3", alpha=0.2))+
theme_classic()+
ylim(0,1500) +
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "", y = Activity)+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
activity <- ggplot(data = baseline,aes(x=as.POSIXct(time),y=Activity)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3, aes(color="Day 3", alpha=0.2))+
theme_classic()+
ylim(0,1500) +
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "", y = "Activity")+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
activity
temperatures/activity/EE
write.csv(lowfat_dehydration_noOL_rep1, "lowfat_dehydration.csv", row.names = FALSE)
temperatures1 <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
ylim(0,0.4) +
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,43), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures1
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
ylim(0,0.4) +
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,43), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
