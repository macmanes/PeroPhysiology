rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1,])
day1 <-
rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day1_rep1,])
day2 <-
rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day2_rep1,])
day3 <-
rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day3_rep1,])
###### for future use
#baseline_temps <-
#  rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% baseline_rep1,],
#        mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% baseline_rep2,])
#day1_temps <-
#  rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day1_rep1,],
#        mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% day1_rep2,])
#day2_temps <-
#  rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day2_rep1,],
#        mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% day2_rep2,])
#day3_temps <-
#  rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day3_rep1,],
#        mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% day3_rep2,])
#baseline <-
#  rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% baseline_rep1,],
#        lowfat_dehydration_noOL_rep2[lowfat_dehydration_noOL_rep2$DateTime %within% baseline_rep2,])
#day1 <-
#  rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day1_rep1,],
#        lowfat_dehydration_noOL_rep2[lowfat_dehydration_noOL_rep2$DateTime %within% day1_rep2,])
#day2 <-
#  rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day2_rep1,],
#        lowfat_dehydration_noOL_rep2[lowfat_dehydration_noOL_rep2$DateTime %within% day2_rep2,])
#day3 <-
#  rbind(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day3_rep1,],
#        lowfat_dehydration_noOL_rep2[lowfat_dehydration_noOL_rep2$DateTime %within% day3_rep2,])
cols <- c("Baseline"="navyblue","Day 1"="sienna1","Day 2"="sienna3", "Day 3"="sienna4")
EE <- ggplot(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% baseline,],aes(x=as.POSIXct(time),y=EE)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day1,], aes(color="Day 1", alpha=0.2))+
geom_point(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day2,], aes(color="Day 2", alpha=0.2))+
geom_point(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day3,], aes(color="Day 3", alpha=0.2))+
theme_classic()+
ylim(0,0.5) +
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day1,], method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day2,], method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day3,], method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "", y = expression(EE ~ (KiloJoules ~ h^-1)))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
baseline
lowfat_dehydration_noOL <- lowfat_dehydration_noOL_rep1
cols <- c("Baseline"="navyblue","Day 1"="sienna1","Day 2"="sienna3", "Day 3"="sienna4")
EE <- ggplot(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% baseline,],aes(x=as.POSIXct(time),y=EE)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day1,], aes(color="Day 1", alpha=0.2))+
geom_point(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day2,], aes(color="Day 2", alpha=0.2))+
geom_point(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day3,], aes(color="Day 3", alpha=0.2))+
theme_classic()+
ylim(0,0.5) +
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day1,], method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day2,], method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day3,], method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "", y = expression(EE ~ (KiloJoules ~ h^-1)))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
baseline
cols <- c("Baseline"="navyblue","Day 1"="sienna1","Day 2"="sienna3", "Day 3"="sienna4")
EE <- ggplot(data = baseline,aes(x=as.POSIXct(time),y=EE)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3, aes(color="Day 3", alpha=0.2))+
theme_classic()+
ylim(0,0.5) +
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "", y = expression(EE ~ (KiloJoules ~ h^-1)))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
EE
dim(day1)
dim(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day1_rep1,],)
dim(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within% day1_rep1,])
dim(lowfat_dehydration_noOL_rep1[lowfat_dehydration_noOL_rep1$DateTime %within% day1_rep1,])
lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day1,]
lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day1_rep1,]
dim(lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day1_rep1,])
lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day1_rep1,]
view(lowfat_dehydration_noOL[lowfat_dehydration_noOL$DateTime %within% day1_rep1,])
dim(lowfat_dehydration_noOL)
dim(lowfat_dehydration_noOL_rep1)
dim(ldr1)
dim(chunk5)
dim(cages)
dim(masterlist_noDup)
length(masterlist_noDup)
cols <- c("Baseline"="navyblue","Day 1"="sienna1","Day 2"="sienna3", "Day 3"="sienna4")
EE <- ggplot(data = baseline,aes(x=as.POSIXct(time),y=EE)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3, aes(color="Day 3", alpha=0.2))+
theme_classic()+
ylim(0,0.4) +
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "", y = expression(EE ~ (KiloJoules ~ h^-1)))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
EE
activity <- ggplot(data = baseline,aes(x=as.POSIXct(time),y=Activity)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3, aes(color="Day 3", alpha=0.2))+
theme_classic()+
ylim(0,1500) +
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "", y = Activity)+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
activity <- ggplot(data = baseline,aes(x=as.POSIXct(time),y=Activity)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3, aes(color="Day 3", alpha=0.2))+
theme_classic()+
ylim(0,1500) +
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "", y = "Activity")+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
activity
temperatures/activity/EE
write.csv(lowfat_dehydration_noOL_rep1, "lowfat_dehydration.csv", row.names = FALSE)
temperatures1 <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
ylim(0,0.4) +
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,43), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures1
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
ylim(0,0.4) +
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,43), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
library(devtools)
library(tidyverse)
library(lubridate)
library(readr)
library(viridis)
library(patchwork)
library(tidyselect)
library(readxl)
library(broom)
library(cowplot)
library(DescTools)
library(ggpubr)
library(plyr)
library(dplyr)
library(pwr)
library(Cairo)
library(ggpattern)
library(hms)
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
mouse_metadata_rep2 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep2/mouse_data_rep2.csv",skip_empty_rows=TRUE) %>%
mutate(date, date = as.Date(date, format = "%d-%m-%y", tz="EST")) %>%
unite("DateTime", date:time, remove = FALSE, sep =  " ") %>%
mutate(DateTime = as.POSIXlt(DateTime), tz="EST")
mouse_metadata_rep1 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep1/mouse_data_rep1.csv",skip_empty_rows=TRUE) %>%
mutate(date, date = as.Date(date, format = "%d-%m-%y", tz="EST")) %>%
unite("DateTime", date:time, remove = FALSE, sep =  " ") %>%
mutate(DateTime = as.POSIXlt(DateTime), tz="EST")
mouse_metadata_rep2 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep2/mouse_data_rep2.csv",skip_empty_rows=TRUE) %>%
mutate(date, date = as.Date(date, format = "%d-%m-%y", tz="EST")) %>%
unite("DateTime", date:time, remove = FALSE, sep =  " ") %>%
mutate(DateTime = as.POSIXlt(DateTime), tz="EST")
baseline_rep1
baseline_rep1 - days(3)
baseline_temp_rep1 <- interval(rep1_water_removal - days(30), rep1_water_removal)
baseline_temp_rep2 <- interval(rep2_water_removal - days(30), rep2_water_removal)
baseline_temps <-
rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within%  baseline_temp_rep1,], mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% baseline_temp_rep2,] )
dim(baseline_temps)
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
mouse_metadata_rep2 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep2/mouse_data_rep2.csv",skip_empty_rows=TRUE) %>%
mutate(date, date = as.Date(date, format = "%d-%m-%y", tz="EST")) %>%
unite("DateTime", date:time, remove = FALSE, sep =  " ") %>%
mutate(DateTime = as.POSIXlt(DateTime), tz="EST")
dim(baseline_temps)
baseline_temps <-
rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within%  baseline_temp_rep1,], mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% baseline_temp_rep2,] )
dim(baseline_temps)
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
setwd("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/R/lowfat_dehydration/")
path <- "C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep1/"
mouse_metadata_rep1 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep1/mouse_data_rep1.csv",skip_empty_rows=TRUE) %>%
mutate(date, date = as.Date(date, format = "%d-%m-%y", tz="EST")) %>%
unite("DateTime", date:time, remove = FALSE, sep =  " ") %>%
mutate(DateTime = as.POSIXlt(DateTime), tz="EST")
mouse_metadata_rep2 <- read_csv("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/data/lowfat_dehydration_rep2/mouse_data_rep2.csv",skip_empty_rows=TRUE) %>%
mutate(date, date = as.Date(date, format = "%d-%m-%y", tz="EST")) %>%
unite("DateTime", date:time, remove = FALSE, sep =  " ") %>%
mutate(DateTime = as.POSIXlt(DateTime), tz="EST")
#source("C:/Users/mdm2000/OneDrive - USNH/Diet_paper/ExploreData_3_using gamm.R")
source("functions.R")
dim(mouse_metadata_rep1)
dim(mouse_metadata_rep2)
rep1_water_removal <- ymd_hms("2022-10-06 11:59:59", tz="EST")
baseline_rep1 <- interval(rep1_water_removal - days(3), rep1_water_removal)
day1_rep1 <- interval(rep1_water_removal, rep1_water_removal + days(1))
day2_rep1 <- interval(rep1_water_removal + days(1), rep1_water_removal + days(2))
day3_rep1 <- interval(rep1_water_removal + days(2), rep1_water_removal + days(3))
rep2_water_removal <- ymd_hms("2022-10-26 11:59:59", tz="EST")
baseline_rep2 <- interval(rep2_water_removal - days(3), rep2_water_removal)
day1_rep2 <- interval(rep2_water_removal, rep2_water_removal + days(1))
day2_rep2 <- interval(rep2_water_removal + days(1), rep2_water_removal + days(2))
day3_rep2 <- interval(rep2_water_removal + days(2), rep2_water_removal + days(3))
baseline_temp_rep1 <- interval(rep1_water_removal - days(30), rep1_water_removal)
baseline_temp_rep2 <- interval(rep2_water_removal - days(30), rep2_water_removal)
dim(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within%  baseline_temp_rep1,])
dim(mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within%  baseline_temp_rep2,])
baseline_temp_rep1
baseline_temp_rep2
rep1_water_removal <- ymd_hms("2022-10-06 11:59:59", tz="EST")
baseline_rep1 <- interval(rep1_water_removal - days(3), rep1_water_removal)
day1_rep1 <- interval(rep1_water_removal, rep1_water_removal + days(1))
day2_rep1 <- interval(rep1_water_removal + days(1), rep1_water_removal + days(2))
day3_rep1 <- interval(rep1_water_removal + days(2), rep1_water_removal + days(3))
rep2_water_removal <- ymd_hms("2022-10-28 11:59:59", tz="EST")
baseline_rep2 <- interval(rep2_water_removal - days(3), rep2_water_removal)
day1_rep2 <- interval(rep2_water_removal, rep2_water_removal + days(1))
day2_rep2 <- interval(rep2_water_removal + days(1), rep2_water_removal + days(2))
day3_rep2 <- interval(rep2_water_removal + days(2), rep2_water_removal + days(3))
baseline_temp_rep1 <- interval(rep1_water_removal - days(30), rep1_water_removal)
baseline_temp_rep2 <- interval(rep2_water_removal - days(30), rep2_water_removal)
dim(mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within%  baseline_temp_rep2,])
baseline_temp_rep1
baseline_temps <-
rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within%  baseline_temp_rep1,], mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% baseline_temp_rep2,] )
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
rep2_water_removal <- ymd_hms("2022-10-31 11:59:59", tz="EST")
baseline_rep2 <- interval(rep2_water_removal - days(3), rep2_water_removal)
day1_rep2 <- interval(rep2_water_removal, rep2_water_removal + days(1))
day2_rep2 <- interval(rep2_water_removal + days(1), rep2_water_removal + days(2))
day3_rep2 <- interval(rep2_water_removal + days(2), rep2_water_removal + days(3))
baseline_temp_rep1 <- interval(rep1_water_removal - days(30), rep1_water_removal)
baseline_temp_rep2 <- interval(rep2_water_removal - days(30), rep2_water_removal)
baseline_temps <-
rbind(mouse_metadata_rep1[mouse_metadata_rep1$DateTime %within%  baseline_temp_rep1,], mouse_metadata_rep2[mouse_metadata_rep2$DateTime %within% baseline_temp_rep2,] )
coeff <- 0
temperatures <- ggplot(data = baseline_temps,aes(x=as.POSIXct(time),y=body_temp)) +
scale_x_datetime(date_breaks = "2 hours", date_labels = "%H:%M") +
annotate("rect", xmin = as.POSIXct("1970-01-01 00:00:01", tz="UTC"),
xmax = as.POSIXct("1970-01-01 06:00:00", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
annotate("rect", xmin = as.POSIXct("1970-01-01 21:00:00", tz="UTC"),
xmax = as.POSIXct("1970-01-01 23:59:59", tz="UTC"),
ymin = -Inf, ymax = Inf, fill="grey84") +
geom_point(aes(color = "Baseline", alpha=0.2))+
geom_point(data = day1_temps, aes(color="Day 1", alpha=0.2))+
geom_point(data = day2_temps, aes(color="Day 2", alpha=0.2))+
geom_point(data = day3_temps, aes(color="Day 3", alpha=0.2))+
geom_point(data = chunk1, aes(x=as.POSIXct(time), y=Deg_C + coeff), size=1, color="black", shape=4)+
labs(x = "")+
theme_classic()+
geom_smooth(method='gam', se = FALSE, aes(color = "Baseline"))+
geom_smooth(data = day1_temps, method='gam', se = FALSE, aes(color = "Day 1"))+
geom_smooth(data = day2_temps, method='gam', se = FALSE, aes(color = "Day 2"))+
geom_smooth(data = day3_temps, method='gam', se = FALSE, aes(color = "Day 3"))+
labs(x = "")+
scale_y_continuous(name = "Body Temperature (°C)", limits = c(20,40), sec.axis = sec_axis(~. - coeff, name="Room Temperature (°C)"))+
guides(alpha = "none")+
scale_colour_manual(name="Dehydration",values=cols, guide="none")
temperatures
source("C:/Users/mdm2000/OneDrive - USNH/PeroPhysiology/R/lowfat_dehydration/gamm.R")
